Function Uninstall-FollinaRemediation
{
    <#
      .DESCRIPTION
        This script is a remediation for CVE-2022-30190. It's built to re-import the keys that are backed up by
        the Install-FollinaRemediation script. 

      .PARAMETER RegPath
        The path and the hive to the root registry key. 

      .EXAMPLE
        Uninstall-FollinaRemediation -RegPath 'HKCR\ms-msdt'

      .NOTES
        Name    : Uninstall-FollinaRemediation
        Author  : bmoadmin
        Github  : https://github.com/bmoadmin
        Created : June 1, 2022
    
        See the following links for information about the exploit. 

        References:
          https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/
          https://nakedsecurity.sophos.com/2022/05/31/mysterious-follina-zero-day-hole-in-office-what-to-do/
    #>
    [CmdletBinding()]
    Param 
    (
        [Parameter(
            Mandatory = $false
        )]
        [string]$RegPath
    )

    if(-not $(Get-Item -Path "registry::$RegPath" -ErrorAction SilentlyContinue))
    {
        reg import "C:\backups\ms-msdt.reg"
        Remove-Item -Path "C:\backups\ms-msdt.reg" -Force
    }
    else 
    {
        Write-Output "$RegPath already exists: please run again"
    }

}

Uninstall-FollinaRemediation -RegPath 'HKCR\ms-msdt'