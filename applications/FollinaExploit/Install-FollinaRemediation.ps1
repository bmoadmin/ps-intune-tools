Function Install-FollinaRemediation
{
    <#
      .DESCRIPTION
        This script is a remediation for CVE-2022-30190, a MSFT exploit specific to microsoft word. The script
        backs up the registry keys associate with the exploit then deletes them from the active registry. 
        See notes for links to the exploit in question. 

      .PARAMETER RegPath
        The path and the hive to the root registry key. 

      .EXAMPLE
        Install-FollinaRemediation -RegPath 'HKCR\ms-msdt'

      .NOTES
        Name    : Install-FollinaRemediation
        Author  : bmoadmin
        Github  : https://github.com/bmoadmin
        Created : June 1, 2022
    
        See the following links for information about the exploit. 

        References:
          https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/
          https://nakedsecurity.sophos.com/2022/05/31/mysterious-follina-zero-day-hole-in-office-what-to-do/
    #>
    [CmdletBinding()]
    Param 
    (
        [Parameter(
            Mandatory = $false
        )]
        [string]$RegPath
    )

    if(Get-Item -Path "registry::$RegPath" -ErrorAction SilentlyContinue)
    {
        if(-not $(Get-Item -Path C:\backups -ErrorAction SilentlyContinue))
        {
            New-Item -ItemType "directory" -Path "C:\backups" | Out-Null
        }
        reg export "$RegPath" "C:\backups\ms-msdt.reg"
        Remove-Item -Path "registry::$RegPath" -Recurse -Force -ErrorAction SilentlyContinue
    }
    else 
    {
        Write-Output "$RegPath does not exist"
    }

}

Install-FollinaRemediation -RegPath 'HKCR\ms-msdt'