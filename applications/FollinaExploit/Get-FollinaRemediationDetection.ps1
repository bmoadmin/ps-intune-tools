Function Get-FollinaRemediationDetection 
{
    <#
      .DESCRIPTION
        This script is a remediation for CVE-2022-30190, a MSFT exploit specific to microsoft word. This is 
        a custom detection script to confirm whether or not the patch script has been installed.

      .PARAMETER RegPath
        The path and the hive to the root registry key.

      .EXAMPLE
        Get-FollinaRemediationDetection -RegPath 'HKCR\ms-msdt'

      .NOTES
        Name    : Get-FollinaRemediationDetection
        Author  : bmoadmin
        Github  : https://github.com/bmoadmin
        Created : June 1, 2022
    
        See the following links for information about the exploit. 

        References:
          https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/
          https://nakedsecurity.sophos.com/2022/05/31/mysterious-follina-zero-day-hole-in-office-what-to-do/
    #>
    [CmdletBinding()]
    Param
    (
        [Parameter(
            Mandatory = $True
        )]
        [string]$RegPath
    )


    if (-not $(Get-Item -Path "registry::$RegPath" -ErrorAction SilentlyContinue)) 
    {
        Write-Output "$RegPath not detected on system"
        exit 0
    }
    else 
    {
        throw "$RegPath detected on system"
        exit 1
    }		
}

Get-FollinaRemediationDetection -RegPath "HKCR\ms-msdt"